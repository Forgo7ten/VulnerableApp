# ContentProviderURI授权不当

## 漏洞简介

在AndroidManifest.xml中，当`<provider>`标签的`android:grantUriPermissions`属性被设置为`true`时，能临时超过`permission`、`readPermission`、`writePermission`属性的限制，使得平常无权对ContentProvider数据的访问进行授权。当ContentProvider存储敏感信息时，可能会造成敏感信息泄露。

### 漏洞详情

条件：

-   含ContentProvider的应用A设置了`<provider>`标签的`grantUriPermissions="true”`属性
-   该应用A启动了应用B，并使用了B的intent，使得B可以添加授权的Flags

当含ContentProvider的应用A，启动另一个应用B时，如果应用A设置了`grantUriPermissions="true”`，即使该provider的`exported="false”`，即使该provider的`permission`、`readPermission`、`writePermission`属性设置了所需的自定义权限。应用B不需要设置权限即可访问该Provider。

正常情况下：即使从应用A启动了应用B，应用B也应含有`permission`等属性所需要的权限才可以访问该provider。

[Android 开发者  | Provider介绍](https://developer.android.google.cn/guide/topics/manifest/provider-element?hl=zh-cn)

### 漏洞危害

导致应用B可以访问应用A的provider，导致数据泄露。

### 修复建议

如果无需对外提供数据，将`<provider>`的`android:grantUriPermissions`属性设置为`false`。

## 漏洞复现

>   复现环境：Pixel; AOSP_Android10.0.0_r2

参考AttackApp应用
